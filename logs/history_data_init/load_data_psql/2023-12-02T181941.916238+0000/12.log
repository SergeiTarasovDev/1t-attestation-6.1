[2023-12-02 19:40:09,212] {{taskinstance.py:670}} INFO - Dependencies all met for <TaskInstance: history_data_init.load_data_psql 2023-12-02T18:19:41.916238+00:00 [queued]>
[2023-12-02 19:40:09,351] {{taskinstance.py:670}} INFO - Dependencies all met for <TaskInstance: history_data_init.load_data_psql 2023-12-02T18:19:41.916238+00:00 [queued]>
[2023-12-02 19:40:09,353] {{taskinstance.py:880}} INFO - 
--------------------------------------------------------------------------------
[2023-12-02 19:40:09,355] {{taskinstance.py:881}} INFO - Starting attempt 12 of 12
[2023-12-02 19:40:09,359] {{taskinstance.py:882}} INFO - 
--------------------------------------------------------------------------------
[2023-12-02 19:40:09,398] {{taskinstance.py:901}} INFO - Executing <Task(PythonOperator): load_data_psql> on 2023-12-02T18:19:41.916238+00:00
[2023-12-02 19:40:09,408] {{standard_task_runner.py:54}} INFO - Started process 3136 to run task
[2023-12-02 19:40:09,538] {{standard_task_runner.py:77}} INFO - Running: ['airflow', 'run', 'history_data_init', 'load_data_psql', '2023-12-02T18:19:41.916238+00:00', '--job_id', '16', '--pool', 'default_pool', '--raw', '-sd', 'DAGS_FOLDER/history_data_init.py', '--cfg_path', '/tmp/tmpmx6aaddd']
[2023-12-02 19:40:09,544] {{standard_task_runner.py:78}} INFO - Job 16: Subtask load_data_psql
[2023-12-02 19:40:09,619] {{logging_mixin.py:120}} INFO - Running <TaskInstance: history_data_init.load_data_psql 2023-12-02T18:19:41.916238+00:00 [running]> on host 4e554c5d2931
[2023-12-02 19:40:09,671] {{base_hook.py:89}} INFO - Using connection to: id: conn1. Host: host.docker.internal, Port: 5434, Schema: quotes, Login: postgres, Password: XXXXXXXX, extra: None
[2023-12-02 19:40:09,708] {{logging_mixin.py:120}} INFO - IBM
[2023-12-02 19:40:56,912] {{logging_mixin.py:120}} INFO - INTC
[2023-12-02 19:42:11,283] {{logging_mixin.py:120}} INFO - TSLA
[2023-12-02 19:43:31,031] {{logging_mixin.py:120}} INFO - SBRCY
[2023-12-02 19:43:31,901] {{taskinstance.py:1150}} ERROR - Ошибка записи данных: 'Time Series (5min)'
Traceback (most recent call last):
  File "/usr/local/airflow/dags/modules/functions.py", line 43, in load_data_psql
    load_data_by_time(conn, symbol)
  File "/usr/local/airflow/dags/modules/functions.py", line 54, in load_data_by_time
    load_data_by_symbol(conn, symbol, month)
  File "/usr/local/airflow/dags/modules/functions.py", line 63, in load_data_by_symbol
    for quote in data[f'Time Series ({interval})']:
KeyError: 'Time Series (5min)'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 984, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 113, in execute
    return_value = self.execute_callable()
  File "/usr/local/lib/python3.7/site-packages/airflow/operators/python_operator.py", line 118, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/usr/local/airflow/dags/modules/functions.py", line 47, in load_data_psql
    raise Exception(f'Ошибка записи данных: {error}')
Exception: Ошибка записи данных: 'Time Series (5min)'
[2023-12-02 19:43:31,908] {{taskinstance.py:1194}} INFO - Marking task as FAILED. dag_id=history_data_init, task_id=load_data_psql, execution_date=20231202T181941, start_date=20231202T194009, end_date=20231202T194331
[2023-12-02 19:43:34,536] {{local_task_job.py:102}} INFO - Task exited with return code 1
